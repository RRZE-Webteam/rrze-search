jQuery(document).ready(function(n){var i,d,l,c,s,o=document.getElementById("search-header"),r=document.getElementById("search-panel"),h=document.getElementById("search-toggle"),e=document.getElementById("headsearchinput"),g=n("body");function u(){e.blur(),setTimeout(a)}var f=function(e){var t=ally.query.firstTabbable({context:e,defaultToContext:!0});t&&t.focus()};function a(){h._toggleSearch(!1)}h._toggleSearch=function(e,t){var a;e!==this._expanded&&(this._expanded=e,this._source=this._expanded&&t||0,g.toggleClass("search-toggled",this._expanded),this.setAttribute("aria-expanded",this._expanded?"true":"false"),this._expanded?(a=f,ally.when.visibleArea({context:o,callback:a||null}),l=ally.maintain.disabled({filter:[o,h,s]}),c=ally.maintain.hidden({filter:o}),d=ally.maintain.tabFocus({context:o}),i=ally.when.key({escape:u}),n(r).prop("hidden",!1)):(i.disengage(),d.disengage(),c.disengage(),l.disengage(),n(r).prop("hidden",!0)))},n(e).click(function(){h._toggleSearch(!0,1)}).keyup(function(e){if([9,16].indexOf(e.which)<0){var t=n(this).val().length;t&&!h._expanded?h._toggleSearch(!0,2):!t&&h._expanded&&2===h._source&&a()}}),n(o).submit(a),n(".search-engine").click(function(){$this=n(this),$this.closest("[role=radiogroup]").find("[tabindex]").attr("tabindex",-1),$this.closest("label").find("a").add(this).attr("tabindex",this.checked?1:-1)});var t=n('<div id="search-backdrop"/>').click(a);n("#meta").before(t),s=t[0]});